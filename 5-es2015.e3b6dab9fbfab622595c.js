(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{z95C:function(t,e,i){"use strict";i.r(e),i.d(e,"FlightsModule",(function(){return G}));var o=i("ofXK"),r=i("tyNb"),n=i("hctd"),c=i("3Pt+"),s=i("fXoL"),a=i("0IaG"),l=i("dNgK"),b=i("lJxs"),d=i("sSZD");let h=(()=>{class t{constructor(t){this.db=t,this.API_URL="/flights"}getFlights(){return this.db.list(this.API_URL).snapshotChanges().pipe(Object(b.a)(t=>t.map(t=>this.assignKey(t))))}getFlight(t){return this.db.object(`${this.API_URL}/${t}`).snapshotChanges().pipe(Object(b.a)(t=>this.assignKey(t)))}editFlight(t,e){return this.db.object(`${this.API_URL}/${t}`).update(e)}removeFlight(t){return this.db.object(`${this.API_URL}/${t}`).remove()}addFlight(t){return this.db.list(this.API_URL).push(t)}assignKey(t){return Object.assign(Object.assign({},t.payload.val()),{key:t.key})}}return t.\u0275fac=function(e){return new(e||t)(s.Xb(d.a))},t.\u0275prov=s.Kb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var f=i("mrSG");const u=t=>t.value.startsWith("SJ")?null:{incorrectCode:!0};var m=i("kmnG"),g=i("qFsG"),p=i("bSwM"),v=i("bTqV"),S=i("NFeN"),T=i("d3UM"),C=i("FKr1");function w(t,e){1&t&&(s.Tb(0,"mat-error"),s.vc(1,"Code is required"),s.Sb())}function F(t,e){1&t&&(s.Tb(0,"mat-error"),s.vc(1,"Min length is 4 chars"),s.Sb())}function k(t,e){1&t&&(s.Tb(0,"mat-error"),s.vc(1,"Max length is 7 chars"),s.Sb())}function y(t,e){1&t&&(s.Tb(0,"mat-error"),s.vc(1,"Code must start with SJ prefix"),s.Sb())}function O(t,e){if(1&t&&(s.Tb(0,"mat-option",25),s.vc(1),s.Sb()),2&t){const t=e.$implicit;s.kc("value",t.value),s.Cb(1),s.wc(t.label)}}function M(t,e){if(1&t){const t=s.Ub();s.Tb(0,"div",17),s.Tb(1,"div",18),s.Tb(2,"div",15),s.Tb(3,"span"),s.vc(4),s.Sb(),s.Tb(5,"mat-icon",19),s.bc("click",(function(){s.oc(t);const i=e.index;return s.fc().removeCrewMember(i)})),s.vc(6,"delete_forever"),s.Sb(),s.Sb(),s.Sb(),s.Tb(7,"div",20),s.Tb(8,"div",21),s.Tb(9,"mat-form-field"),s.Pb(10,"input",22),s.Sb(),s.Sb(),s.Tb(11,"div",7),s.Tb(12,"mat-form-field"),s.Tb(13,"mat-select",23),s.uc(14,O,2,2,"mat-option",24),s.Sb(),s.Sb(),s.Sb(),s.Sb(),s.Sb()}if(2&t){const t=e.index,i=s.fc();s.Cb(4),s.xc("Crew Member - ",t+1,""),s.Cb(3),s.kc("formGroupName",t),s.Cb(7),s.kc("ngForOf",i.jobs)}}let I=(()=>{class t{constructor(t){this.formBuilder=t,this.editMode=!1,this.jobs=[{label:"Stweradess",value:"stweradess"},{label:"Senior Cabin Crew",value:"senior_cabin_crew"},{label:"Pilot",value:"pilot"},{label:"Co-Pilot",value:"co_pilot"},{label:"Mechanic",value:"mechanic"}]}ngOnInit(){this.buildForm()}setFlight(t){const e=Object(f.__rest)(t,["key"]);this.form.patchValue(e),e.crew.forEach(t=>this.addCrewMember(t))}get crew(){return this.form.get("crew")}addCrewMember(t){this.crew.push(this.buildCrewMember(t))}buildCrewMember(t={}){return this.formBuilder.group({name:t.name||"",job:t.job||""})}removeCrewMember(t){this.crew.removeAt(t)}buildForm(){this.form=this.formBuilder.group({origin:["",{validators:[c.r.required]}],destination:["",{validators:[c.r.required]}],departureTime:["",{validators:[c.r.required]}],returnTime:["",{validators:[c.r.required]}],code:["SJ",{validators:[c.r.required,c.r.minLength(4),c.r.maxLength(7),u]}],additionalInformation:"",withSKPlanesDiscount:!1,crew:this.formBuilder.array(this.editMode?[]:[this.buildCrewMember()])})}}return t.\u0275fac=function(e){return new(e||t)(s.Ob(c.d))},t.\u0275cmp=s.Ib({type:t,selectors:[["app-flights-form"]],inputs:{editMode:"editMode"},decls:41,vars:10,consts:[[3,"formGroup"],[1,"row"],[1,"col-sm-8"],["matInput","","formControlName","code","placeholder","Code"],["codeInput",""],[4,"ngIf"],["align","end"],[1,"col-sm-4"],["matInput","","formControlName","origin","placeholder","Origin"],["matInput","","formControlName","destination","placeholder","Destination"],["matInput","","formControlName","departureTime","placeholder","Departure time"],["matInput","","formControlName","returnTime","placeholder","Return time"],["matInput","","formControlName","additionalInformation","placeholder","Additional Information"],["formControlName","withSKPlanesDiscount"],["formArrayName","crew","class","crew-container shadow",4,"ngFor","ngForOf"],[1,"col"],["mat-raised-button","","color","primary",3,"click"],["formArrayName","crew",1,"crew-container","shadow"],[1,"row","crew-header"],[1,"float-right",3,"click"],[1,"row",3,"formGroupName"],[1,"col-sm-5"],["matInput","","placeholder","Name","formControlName","name"],["placeholder","Job","formControlName","job"],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(t,e){if(1&t&&(s.Tb(0,"form",0),s.Tb(1,"div",1),s.Tb(2,"div",2),s.Tb(3,"mat-form-field"),s.Pb(4,"input",3,4),s.uc(6,w,2,0,"mat-error",5),s.uc(7,F,2,0,"mat-error",5),s.uc(8,k,2,0,"mat-error",5),s.uc(9,y,2,0,"mat-error",5),s.Tb(10,"mat-hint",6),s.vc(11),s.Sb(),s.Sb(),s.Sb(),s.Sb(),s.Tb(12,"div",1),s.Tb(13,"div",7),s.Tb(14,"mat-form-field"),s.Pb(15,"input",8),s.Sb(),s.Sb(),s.Tb(16,"div",7),s.Tb(17,"mat-form-field"),s.Pb(18,"input",9),s.Sb(),s.Sb(),s.Sb(),s.Tb(19,"div",1),s.Tb(20,"div",7),s.Tb(21,"mat-form-field"),s.Pb(22,"input",10),s.Sb(),s.Sb(),s.Tb(23,"div",7),s.Tb(24,"mat-form-field"),s.Pb(25,"input",11),s.Sb(),s.Sb(),s.Sb(),s.Tb(26,"div",1),s.Tb(27,"div",2),s.Pb(28,"textarea",12),s.Sb(),s.Sb(),s.Tb(29,"div",1),s.Tb(30,"div",2),s.Tb(31,"mat-checkbox",13),s.vc(32,"With SK Discount"),s.Sb(),s.Sb(),s.Sb(),s.uc(33,M,15,3,"div",14),s.Tb(34,"div",1),s.Tb(35,"div",15),s.Tb(36,"button",16),s.bc("click",(function(){return e.addCrewMember()})),s.vc(37,"Add crew member"),s.Sb(),s.Sb(),s.Sb(),s.Sb(),s.Tb(38,"pre"),s.vc(39),s.gc(40,"json"),s.Sb()),2&t){const t=s.nc(5);s.kc("formGroup",e.form),s.Cb(6),s.kc("ngIf",e.form.get("code").hasError("required")),s.Cb(1),s.kc("ngIf",e.form.get("code").hasError("minlength")),s.Cb(1),s.kc("ngIf",e.form.get("code").hasError("maxlength")),s.Cb(1),s.kc("ngIf",e.form.get("code").hasError("incorrectCode")),s.Cb(2),s.xc("",t.value.length," / 7"),s.Cb(22),s.kc("ngForOf",e.crew.controls),s.Cb(6),s.wc(s.hc(40,8,e.form.value))}},directives:[c.s,c.m,c.f,m.c,g.a,c.b,c.l,c.e,o.l,m.f,p.a,o.k,v.a,m.b,c.c,S.a,c.g,T.a,C.f],pipes:[o.f],styles:[".crew-container[_ngcontent-%COMP%]{margin-top:15px;padding:15px;background:#fff}.crew-header[_ngcontent-%COMP%]{margin-bottom:20px;font-weight:700}"]}),t})();const P=["flightForm"];let x=(()=>{class t{constructor(t,e,i){this.dialogRef=t,this.toast=e,this.flightsService=i}createFlight(){console.log(this.flightForm),this.flightsService.addFlight(this.flightForm.form.value).then(this.onCreatingSucces.bind(this),this.onCreatingFailure.bind(this))}onCreatingSucces(){this.dialogRef.close(),this.toast.open("Flight has been successfully created!","",{panelClass:"toast-success"})}onCreatingFailure(t){console.log("some error"),this.toast.open(t.message,"",{panelClass:"toast-error"})}}return t.\u0275fac=function(e){return new(e||t)(s.Ob(a.h),s.Ob(l.b),s.Ob(h))},t.\u0275cmp=s.Ib({type:t,selectors:[["app-new-flight"]],viewQuery:function(t,e){var i;1&t&&s.Ac(P,!0),2&t&&s.mc(i=s.cc())&&(e.flightForm=i.first)},decls:12,vars:1,consts:[["mat-dialog-title",""],["flightForm",""],[1,"row"],[1,"col"],["mat-raised-button","","mat-dialog-close",""],["mat-raised-button","","color","primary",3,"disabled","click"]],template:function(t,e){if(1&t&&(s.Tb(0,"h2",0),s.vc(1,"New Flight Creator"),s.Sb(),s.Tb(2,"mat-dialog-content"),s.Pb(3,"app-flights-form",null,1),s.Sb(),s.Tb(5,"mat-dialog-actions"),s.Tb(6,"div",2),s.Tb(7,"div",3),s.Tb(8,"button",4),s.vc(9,"Cancel"),s.Sb(),s.Tb(10,"button",5),s.bc("click",(function(){return e.createFlight()})),s.vc(11,"Create"),s.Sb(),s.Sb(),s.Sb(),s.Sb()),2&t){const t=s.nc(4);s.Cb(10),s.kc("disabled",t.form.invalid)}},directives:[a.i,a.f,I,a.d,v.a,a.e],styles:[""]}),t})();function _(t,e){if(1&t&&(s.Tb(0,"li"),s.vc(1),s.Sb()),2&t){const t=e.$implicit;s.Cb(1),s.xc(" ",t.name," ")}}let N=(()=>{class t{constructor(t,e,i){this.router=t,this.dialogRef=e,this.data=i,this.flight=i}close(){this.dialogRef.close()}goToEditFlight(){this.dialogRef.close(),this.router.navigate(["/dashboard/flights",this.flight.key])}}return t.\u0275fac=function(e){return new(e||t)(s.Ob(r.b),s.Ob(a.h),s.Ob(a.a))},t.\u0275cmp=s.Ib({type:t,selectors:[["app-details"]],decls:14,vars:2,consts:[[1,"row"],[1,"col"],[1,"float-right",3,"click"],[1,"label"],[4,"ngFor","ngForOf"],["mat-raised-button","","color","primary",1,"float-right",3,"click"]],template:function(t,e){1&t&&(s.Tb(0,"div",0),s.Tb(1,"div",1),s.Tb(2,"h3"),s.vc(3," FLIGHT DETAILS "),s.Tb(4,"mat-icon",2),s.bc("click",(function(){return e.close()})),s.vc(5,"close"),s.Sb(),s.Sb(),s.Tb(6,"p",3),s.vc(7),s.Sb(),s.Tb(8,"p",3),s.vc(9,"Crew:"),s.Sb(),s.Tb(10,"ul"),s.uc(11,_,2,1,"li",4),s.Sb(),s.Tb(12,"button",5),s.bc("click",(function(){return e.goToEditFlight()})),s.vc(13," EDIT FLIGHT "),s.Sb(),s.Sb(),s.Sb()),2&t&&(s.Cb(7),s.xc("Code: ",e.flight.code,""),s.Cb(4),s.kc("ngForOf",e.flight.crew))},directives:[S.a,o.k,v.a],styles:["mat-icon[_ngcontent-%COMP%]{cursor:pointer}"]}),t})(),j=(()=>{class t{constructor(){this.math=Math}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=s.Ib({type:t,selectors:[["app-flight-card"]],inputs:{flight:"flight"},decls:15,vars:4,consts:[[1,"card-container"],[1,"shadow","card-content"],[1,"row"],[1,"col"],[1,"origin"],[1,"destination"],[1,"time"],[1,"icon-container","shadow"]],template:function(t,e){1&t&&(s.Tb(0,"div",0),s.Tb(1,"div",1),s.Tb(2,"div",2),s.Tb(3,"div",3),s.Tb(4,"p",4),s.vc(5),s.Sb(),s.Tb(6,"p",5),s.vc(7),s.Sb(),s.Sb(),s.Sb(),s.Tb(8,"div",2),s.Tb(9,"div",3),s.Tb(10,"p",6),s.vc(11),s.Sb(),s.Sb(),s.Sb(),s.Sb(),s.Tb(12,"div",7),s.Tb(13,"mat-icon"),s.vc(14,"airplanemode_active"),s.Sb(),s.Sb(),s.Sb()),2&t&&(s.Cb(5),s.wc(e.flight.origin),s.Cb(2),s.wc(e.flight.destination),s.Cb(4),s.yc("",e.flight.departureTime," - ",e.flight.returnTime,""))},directives:[S.a],styles:["[_nghost-%COMP%]{cursor:pointer}.card-container[_ngcontent-%COMP%]{padding:10px;position:relative}.card-content[_ngcontent-%COMP%]{padding:30px 20px;background:#fff;border:2px solid #696969}.icon-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;position:absolute;left:50%;top:-10px;width:50px;height:50px;background:#fff;border-radius:50%;z-index:10;border:1px solid grey;transform:translateX(-50%)}.icon-container[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#483d8b}.time[_ngcontent-%COMP%]{text-align:center;font-size:13px;color:grey}.destination[_ngcontent-%COMP%], .origin[_ngcontent-%COMP%]{font-size:26px;font-weight:700;color:#ff4500}"],changeDetection:0}),t})();function A(t,e){if(1&t){const t=s.Ub();s.Tb(0,"div",3),s.bc("click",(function(){s.oc(t);const i=e.$implicit;return s.fc().showDetails(i)})),s.Pb(1,"app-flight-card",4),s.Sb()}if(2&t){const t=e.$implicit;s.Cb(1),s.kc("flight",t)}}let E=(()=>{class t{constructor(t,e){this.dialog=t,this.flightsService=e,this.flights$=this.flightsService.getFlights()}openNewFlightModel(){this.dialog.open(x)}showDetails(t){this.dialog.open(N,{data:t})}}return t.\u0275fac=function(e){return new(e||t)(s.Ob(a.c),s.Ob(h))},t.\u0275cmp=s.Ib({type:t,selectors:[["app-flights"]],decls:5,vars:3,consts:[[1,"row","flights-container"],["class","col-sm-4",3,"click",4,"ngFor","ngForOf"],["mat-fab","","color","accent","id","new-flight-btn",3,"click"],[1,"col-sm-4",3,"click"],[3,"flight"]],template:function(t,e){1&t&&(s.Tb(0,"div",0),s.uc(1,A,2,1,"div",1),s.gc(2,"async"),s.Sb(),s.Tb(3,"button",2),s.bc("click",(function(){return e.openNewFlightModel()})),s.vc(4,"+"),s.Sb()),2&t&&(s.Cb(1),s.kc("ngForOf",s.hc(2,1,e.flights$)))},directives:[o.k,v.a,j],pipes:[o.b],styles:[".flights-container[_ngcontent-%COMP%]{padding-top:30px}#new-flight-btn[_ngcontent-%COMP%]{position:fixed;bottom:50px;right:50px;font-size:30px}"]}),t})();var R=i("vkgz");const L=["flightForm"],$=[{path:"",component:E},{path:":key",component:(()=>{class t{constructor(t,e,i,o){this.route=t,this.toast=e,this.router=i,this.flightsService=o}ngOnInit(){this.loadFlight()}removeFlight(){this.flightsService.removeFlight(this.flight.key).then(this.onRemoveSuccess.bind(this),this.onFailure.bind(this))}editFlight(){this.flightsService.editFlight(this.flight.key,this.flightForm.form.value).then(this.onEditSuccess.bind(this),this.onFailure.bind(this))}onEditSuccess(){this.router.navigate(["/dashboard"]),this.toast.open("Flight has been successfully edited","",{panelClass:"toast-success"})}onRemoveSuccess(){this.router.navigate(["/dashboard"]),this.toast.open("Flight has been successfully removed","",{panelClass:"toast-success"})}onFailure(t){this.toast.open(t.message,"",{panelClass:"toast-error"})}loadFlight(){this.flightsService.getFlight(this.route.snapshot.params.key).pipe(Object(R.a)(t=>this.flightForm.setFlight(t))).subscribe(t=>this.flight=t)}}return t.\u0275fac=function(e){return new(e||t)(s.Ob(r.a),s.Ob(l.b),s.Ob(r.b),s.Ob(h))},t.\u0275cmp=s.Ib({type:t,selectors:[["app-edit-flight"]],viewQuery:function(t,e){var i;1&t&&s.Ac(L,!0),2&t&&s.mc(i=s.cc())&&(e.flightForm=i.first)},decls:19,vars:2,consts:[[1,"row"],[1,"col-9"],[1,"col-3"],["id","remove-button",3,"click"],[3,"editMode"],["flightForm",""],[1,"col","text-right"],["mat-raised-button",""],["mat-raised-button","","color","primary",3,"click"]],template:function(t,e){1&t&&(s.Tb(0,"div",0),s.Tb(1,"div",1),s.Tb(2,"h3"),s.vc(3,"Edit flight "),s.Tb(4,"strong"),s.vc(5),s.Sb(),s.vc(6," details"),s.Sb(),s.Sb(),s.Tb(7,"div",2),s.Tb(8,"mat-icon",3),s.bc("click",(function(){return e.removeFlight()})),s.vc(9,"delete_forever"),s.Sb(),s.Sb(),s.Sb(),s.Tb(10,"mat-dialog-content"),s.Pb(11,"app-flights-form",4,5),s.Sb(),s.Tb(13,"div",0),s.Tb(14,"div",6),s.Tb(15,"button",7),s.vc(16,"RESET"),s.Sb(),s.Tb(17,"button",8),s.bc("click",(function(){return e.editFlight()})),s.vc(18,"SAVE"),s.Sb(),s.Sb(),s.Sb()),2&t&&(s.Cb(5),s.wc(null==e.flight?null:e.flight.code),s.Cb(6),s.kc("editMode",!0))},directives:[S.a,a.f,I,v.a],styles:["#remove-button[_ngcontent-%COMP%]{color:#8b0000}"]}),t})()}];let D=(()=>{class t{}return t.\u0275mod=s.Mb({type:t}),t.\u0275inj=s.Lb({factory:function(e){return new(e||t)},imports:[[r.d.forChild($)],r.d]}),t})(),G=(()=>{class t{}return t.\u0275mod=s.Mb({type:t}),t.\u0275inj=s.Lb({factory:function(e){return new(e||t)},imports:[[o.c,n.a,r.d,c.h,c.p,D]]}),t})()}}]);